# VictorNLP_STS: A multi-model, multi-lingual semantic text similarity package.

## Summary

### Semantic Text Similarity

Semantic Text Similarity is a regression task between two sentences. It aims to calculate the semantic similarity between two sentences. Note that two sentences may not entail each other, or even are contradictory, but may have high correlation between them. VictorNLP-STS framework supplies various deep learning STS models. In-depth description of resources and their implementation details are recorded right here:

[VictorNLP_STS Documentation](https://www.notion.so/jinulee/VictorNLP_STS-10fc21e8a1fc4d0a812e2e5742381982)

### VictorNLP Framework

VictorNLP, a PyTorch-based NLP framework, provides intuitive interfaces and carefully designed code modularity for implementing and pipelining NLP modules. For more details, refer to the VictorNLP Specification page.

[VictorNLP Specification](https://www.notion.so/VictorNLP-Specification-e03ed18b4a034e3baa16f17793781a90)

## Installation

1. Clone the repository to your local computer.
```
git clone https://github.com/jinulee-v/victornlp_sts
```

2. Install `victornlp_sts package` using `pip`.
```
cd victornlp_sts
mkdir corpus model
pip install -e ./victornlp_sts
```

> Note: All commands in this documentation should be executed in the same directory.
> 
> ls 
>
> corpus model victornlp_dp

3. Install dependencies.

```
pip install -r victornlp_sts/requirements.txt
apt-get install default-jre # For KOMORAN PoS tagger; optional
cd ..
```

## How-to:

### Prepare Datasets and pretrained embeddings

#### Dataset: TODO

#### Pretrained embeddings

Refer to [VictorNLP_Utils documentation](https://github.com/jinulee-v/victornlp_dp).

Add downloaded files to `victornlp_sts/victornlp_utils/data` as instructed.

If the script raises NotFoundError, precautious warnings containing missing dependencies are printed.

### Train model

This script automatically reads `config_file` and starts training. However, for convenience, overriding configuration file with command line arguments is supported. However, to reduce command line bizarreness, we only support major hyper-parameters. Details like model hyperparameters(num_layers, dropout, ...) are likely to be modified directly in `victornlp_dp/config.json` or other config files.

```
python -m victornlp_sts.train
```

Refer to `python -m victornlp_sts.train -h` for more information, and `train.sh` for some demos.

### Fine-tune model

This script also supports fine-tuning for different possible situations:
- Re-train with another corpus.
- Fine-tuning of pre-trained embeddings.
Refer to the following code snippet or `train-finetune.sh` for examples. You can override any cmd line argument-supported hyperparameter just as training, and you can also modify `models/Example_name/config.json` for more precise and specific tuning.

```
python -m victornlp_sts.train --finetune-model models/Example_name
```
> ls models/Example
>
> - model.pt
> - config.json

### Test model

Use this script to test model stats or parse sentences of interest. You only require `--model-dir` argument which is a directory name that contains `model.pt` and `config.json`. These two files are automatically generated by the `victornlp_sts.train` script. Command line arguments can modify the script's behavior from testing to parsing. Details are given below.

```
python victornlp_sts.test --model-dir ./model/(folder name)
```

Optional Command line arguments:
- `-a`, `--analyze` : Can freely select which analyzing functions(`victornlp_sts/tools/analyze.py`) to apply. Test set requires golden labels
- `--data-file` : `path/to/input/file`. Load VictorNLP_format .json file to parse. If not provided, parses `stdin` inputs(line by line, PoS automatically tagged).
- `--save-result` : `path/to/store/parsed_file.json`. Stores parsed result in the designated path.
